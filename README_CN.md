# AutoPipeline 低代码平台使用指南

## 简介

AutoPipeline 是一个基于 PyQt5 开发的可视化低代码自动化平台，允许用户通过拖拽节点的方式创建自动化工作流程，无需编写复杂的代码即可实现各种自动化任务。

## 主要功能

### 🎯 核心节点类型

- **鼠标操作**
  - 左键单击：点击指定图像位置
  - 双击：双击指定图像位置
  - 右键单击：右键点击指定图像位置

- **文本输入**
  - 输入文本：向当前焦点输入指定文本
  - 支持清除原文本选项（勾选框形式）

- **系统操作**
  - 等待：暂停执行指定秒数
  - 滚动：鼠标滚轮滚动
  - 热键：执行键盘快捷键组合
  - 粘贴时间：粘贴当前时间戳
  - 执行命令：运行系统命令

- **流程控制**
  - For循环：重复执行指定次数的循环
  - 循环结束：标记循环边界，控制循环范围

### 🔧 高级功能

- **可视化编辑器**：直观的节点拖拽界面
- **连接模式**：通过连线定义节点执行顺序
- **参数配置**：双击节点设置详细参数
- **工作流保存/加载**：支持 JSON 格式的工作流文件
- **实时执行**：一键运行整个工作流

## 快速开始

### 1. 启动平台

```bash
python pyqt_lowcode_platform.py
```

### 2. 创建第一个工作流

1. **添加节点**
   - 在左侧工具栏点击所需节点类型
   - 节点会自动添加到画布中央

2. **配置节点参数**
   - 双击节点打开参数设置对话框
   - 根据节点类型配置相应参数
   - 布尔类型参数以勾选框形式呈现

3. **连接节点**
   - 点击"连接模式"按钮
   - 依次点击要连接的节点（从起始节点到目标节点）
   - 右键或按 ESC 退出连接模式

4. **执行工作流**
   - 点击"执行"按钮运行整个工作流
   - 观察控制台输出了解执行状态

### 3. 保存和加载工作流

- **保存**：点击"保存工作流"按钮，选择保存位置
- **加载**：点击"加载工作流"按钮，选择已保存的 JSON 文件

## 详细使用说明

### 节点参数配置

#### 鼠标操作节点
- **图像文件**：目标图像的文件名（放在 images 文件夹中）
- **重试次数**：查找图像失败时的重试次数

#### 文本输入节点
- **文本内容**：要输入的文本
- **清除原文本**：勾选后会先清除输入框中的原有内容

#### 等待节点
- **等待时间**：暂停的秒数（支持小数）

#### 滚动节点
- **滚动量**：滚动的像素数（正数向上，负数向下）
- **重复次数**：滚动操作的重复次数

#### 热键节点
- **按键组合**：用逗号分隔的按键（如：ctrl,c）
- **重复次数**：热键操作的重复次数

#### For循环节点
- **循环次数**：循环执行的次数
- **循环变量名**：循环中使用的变量名

### For循环使用方法

1. **添加For循环节点**
   - 设置循环次数和变量名

2. **添加循环体节点**
   - 在For循环节点后添加要重复执行的节点

3. **添加循环结束节点**
   - 在循环体末尾添加"循环结束"节点
   - 标记循环的边界范围

4. **连接后续节点**
   - 在"循环结束"节点后可以继续添加其他节点
   - 这些节点会在循环完成后执行

### 工作流执行逻辑

- 工作流从没有前置连接的节点开始执行
- 按照连接顺序依次执行节点
- For循环会重复执行循环体内的所有节点
- 循环结束后继续执行后续节点

## 最佳实践

### 1. 图像文件管理
- 将所有目标图像放在 `images` 文件夹中
- 使用清晰、易识别的图像
- 建议使用 PNG 格式以获得最佳识别效果

### 2. 工作流设计
- 合理使用等待节点，确保界面加载完成
- 为关键操作设置重试次数
- 使用描述性的节点名称便于维护

### 3. 调试技巧
- 先测试单个节点的功能
- 逐步构建复杂的工作流
- 观察控制台输出了解执行状态

### 4. 错误处理
- 检查图像文件是否存在
- 确认参数配置是否正确
- 验证节点连接关系

## 常见问题

### Q: 图像识别失败怎么办？
A: 检查图像文件是否存在于 images 文件夹中，确保图像清晰且与屏幕显示一致。

### Q: 如何调整鼠标移动速度？
A: 可以在 Autobot.py 中修改 `mouse_speed` 参数。

### Q: 循环没有按预期执行？
A: 确保添加了"循环结束"节点来标记循环边界，检查节点连接是否正确。

### Q: 文本输入不生效？
A: 确保目标输入框已获得焦点，可以先添加一个点击操作。

## 技术支持

如果遇到问题或需要新功能，请查看项目文档或提交反馈。AutoPipeline 持续更新中，致力于提供更好的自动化体验。

---

**AutoPipeline** - 让自动化变得简单高效！
